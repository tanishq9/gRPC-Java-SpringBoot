## Introduction
- IDL (interface description language) for API
- Language neutral
- Very fast/optimised for inter-service communication
- In proto version 3, all fields are required by default.
    - If fields are not set, default value would be set for them.

Note - We cannot override the equals method of autogenerated class. To do case-insensitive check on values of fields, we would have to write a custom method which does that.

## Scalar Types
Scalar types in proto -
- int32 (equivalent to int in java)
- int64 (equivalent to long in java)
- float (equivalent to float in java)
- double (equivalent to double in java)
- bool (equivalent to boolean in java)
- string (equivalent to String in java)
- bytes (equivalent to byte[] in java)

Collection -
- repeated (equivalent to collection/list in java)
- map (equivalent to Map in java)

Enum -
```
enum Style {
  SEDAN = 0; // first enum value must be 0, it is the default
  COUPE = 1;
  SUV = 2;
}
```

### Default Values
Defaults -
- int32/any number type - 0
- bool - false
- string - empty string
- enum - first value
- repeated - empty list
- map - empty map
- More - https://protobuf.dev/programming-guides/proto3/#:~:text=For%20bools%2C%20the%20default%20value,the%20field%20is%20not%20set.

Notes -
- There is no null in protobuf, either you get the actual object what is passed otherwise it gives the default value.
- However there is one issue with default value, for example if some string field's value is "" i.e. the default value then we wouldn't know the difference even if someone set it purposely.
- For the above problem, we can use .hasFieldName() to check if the field was actually set in the proto. But this has method would only be generated for the message field type and not for the primitive types. Workaround discussed in further sections.
    - Proto Wrapper Types are the object equivalent of the primitive types.
    - The benefit of using this over primitive type is that hasFieldName() method is generated for this wrapper type.

```
message Person {
  string name = 1;
  google.protobuf.Int32Value age = 2;
}

// In Java code
System.out.println(personAlter.hasAge());
```

## OneOf

```
Credentials credentials = Credentials.newBuilder()
  .setEmailMode(emailCredentials)
  .setPhoneMode(phoneOTP) // only one value is picked in oneof, which would be last one, like phoneMode here
  .build();
```

## How it works?
- The number assigned to every field in the message called tag.
```
message Person {
    string name = 1;
}
```
- What the community recommends is -
    - 1 - 15, uses 1 byte
    - 16-2047, uses 2 bytes
- When designing the proto, assign tag b/w 1 to 15 for frequently used fields. Why is that? Because the tags (>15) assigned to less frequently used fields would consume more bytes (i.e. 2). And since these less frequently used fields won't be set always, so the byte size (during serialising) would be less and proto can be send more quickly over the network.

## Tags
- The tags are used internally to map the fields. So do not change the field number once it is in use as a best practice.
- When removing fields from proto, don't forget to reserve the tag that was assigned to that field like - reserved 2; if field with tag 2 was removed.
